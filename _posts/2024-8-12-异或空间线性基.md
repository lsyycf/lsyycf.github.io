---
layout: post
title: "异或空间线性基"
date:   2024-8-12
tags: [算法竞赛,数论和线性代数]
comments: true
author: lsyycf

---

通过高斯消元，得到最小线性基，进而求解第k小异或和问题
<!-- more -->

```
#include <bits/stdc++.h>
#define io cin.tie(0), cout.tie(0), ios::sync_with_stdio(false)
#define LL long long
#define ULL unsigned long long
#define EPS 1e-8
#define INF 0x7fffffff
#define SUB -INF - 1
using namespace std;
const int N = 10100;
int n;
bool zero;
LL a[N];
void Gauss()
{
    int i, k = 1;
    LL j = (LL)1 << 62;
    for (; j; j >>= 1)
    {
        for (i = k; i <= n; i++)
            if (a[i] & j)
                break;
        if (i > n)
            continue;
        swap(a[i], a[k]);
        for (i = 1; i <= n; i++)
            if (i != k && a[i] & j)
                a[i] ^= a[k];
        k++;
    }
    k--;
    if (k != n)
        zero = true;
    else
        zero = false;
    n = k;
}
LL Query(LL k)
{
    LL ans = 0;
    if (zero)
        k--;
    if (!k)
        return 0;
    for (int i = n; i; i--)
    {
        if (k & 1)
            ans ^= a[i];
        k >>= 1;
    }
    if (k)
        return -1;
    return ans;
}
int main()
{
    int cnt = 0;
    int T;
    cin >> T;
    while (T--)
    {
        printf("Case #%d:\n", ++cnt);
        cin >> n;
        for (int i = 1; i <= n; i++)
            scanf("%lld", &a[i]);
        Gauss();
        int q;
        cin >> q;
        while (q--)
        {
            LL k;
            scanf("%lld", &k);
            printf("%lld\n", Query(k));
        }
    }
    return 0;
}
```

